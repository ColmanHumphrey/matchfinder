<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Prepares design matrices and other inputs needed for predictive methods — predict_prepare • matchfinder</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/journal/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Prepares design matrices and other inputs needed for predictive methods — predict_prepare" />
<meta property="og:description" content="It is not immediately clear how to take a match (set of matched pairs)
and &quot;predict&quot; it - essentially you likely want some prediction
function \(f(x, y) -&amp;gt; {0, 1}\) (or \(P(1)\) etc) where \(x\)
and \(y\) are rows, one of which is treated and the other control.
This function should also have a property resembling:
$$f(x, y) = 1 - f(y, x)$$ since there's an inherent symmetry
in the pairs: if you knew which of the two came first, there'd
be nothing to do. In fact, the defition of \(f\) would likely be
to predict if (WLOG) \(x\) is the treated unit or not." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">matchfinder</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Prepares design matrices and other inputs needed for predictive methods</h1>
    
    <div class="hidden name"><code>predict_prepare.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>It is not immediately clear how to take a match (set of matched pairs)
and "predict" it - essentially you likely want some prediction
function \(f(x, y) -&gt; {0, 1}\) (or \(P(1)\) etc) where \(x\)
and \(y\) are rows, one of which is treated and the other control.
This function should also have a property resembling:
$$f(x, y) = 1 - f(y, x)$$ since there's an inherent symmetry
in the pairs: if you knew which of the two came first, there'd
be nothing to do. In fact, the defition of \(f\) would likely be
to predict if (WLOG) \(x\) is the treated unit or not.</p>
    </div>

    <pre class="usage"><span class='fu'>predict_prepare</span>(
  <span class='no'>x_mat</span>,
  <span class='no'>index_list</span>,
  <span class='kw'>design</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"cross_all"</span>, <span class='st'>"cross_random"</span>, <span class='st'>"differences_random"</span>, <span class='st'>"differences_plain"</span>)
)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>x_mat</th>
      <td><p>original data, i.e. row for each unit</p></td>
    </tr>
    <tr>
      <th>index_list</th>
      <td><p>list of indices to use in the matching:</p><dl'>
  <dt><code>treat_train</code></dt><dd><p>Index of treated units for the training matrix</p></dd>
  <dt><code>control_train</code></dt><dd><p>Index of control units for the training matrix</p></dd>
  <dt><code>treat_test</code></dt><dd><p>Index of treated units for the test matrix</p></dd>
  <dt><code>control_test</code></dt><dd><p>Index of control units for the test matrix</p></dd>

</dl></td>
    </tr>
    <tr>
      <th>design</th>
      <td><p>The design matrix form do you want to use.
We'll assume that <code>x_mat</code> is \(n \times k\).
Let \(X_c\) be the rows of <code>x_mat</code> corresponding
to the control units, and \(X_t\) the treated units that
pair with \(X_c\) (i.e. so the \(i^{\text{th}}\) matched
pair will correspond with the \(i^{\text{th}}\) row of each),
and thus each matrix will have dimension \(m \times k\),
where \(2m \leq n\).</p><dl'>
  <dt><code>"cross_all"</code></dt><dd><p>This will form the \(2m \times 2k\) matrix, by having each matched pair
give two rows in the design matrix: each of the two
rows will contain the full treated row of the given pair along with the full
control row, but in one row the pair will be (treated, control), and in the other
(control, treated). For these two rows, the output vector will contain a 1 and a 0
respectively. We construct the following inputs:
$$X =
  \begin{bmatrix}
  X_t&amp; X_c \\
  X_c&amp; X_t \\
  \end{bmatrix}, Y = [1 1 \hdots 1 0 0 \hdots 0]'
$$
For the test data, we'll only (WLOG more or less) give the (treat, control)
version, for consistency in evaluation.</p></dd>
   <dt><code>"cross_random"</code></dt><dd><p>This is similar to the above, except instead of forming all rows in both
ways, we choose (for each pair) between (treated, control) and
(control, treated) randomly. So
$$Y_i =
\begin{cases}
1 &amp; \text{with probability} 0.5 \\
0 &amp; \text{with probability} 0.5
\end{cases}$$
And (\(X_i\) here meaning the \(i^{\text{th}}\) row of the design matrix):
$$X_i =
\begin{cases}
((X_t)_i, (X_c)_i) &amp; Y_i = 1 \\
((X_c)_i, (X_t)_i) &amp; Y_i = 0
\end{cases}$$
Giving an \(m \times 2k\) design matrix.</p></dd>
  <dt><code>"differences_random"</code></dt><dd><p>For
each pair, our design row will be
the row in <code>x_mat</code> corresponding to
one unit minus the row corresponding to the
other. Similar to the above, we'll choose
the outcome randomly and decide which unit will
be subtracted from the other based on that, and we'll end up with
an \(m \times k\) matrix.
That is:
$$Y_i =
\begin{cases}
1 &amp; \text{with probability} 0.5 \\
0 &amp; \text{with probability} 0.5
\end{cases}$$
And:
$$X_i =
\begin{cases}
(X_t)_i - (X_c)_i &amp; Y_i = 1 \\
(X_c)_i - (X_t)_i &amp; Y_i = 0
\end{cases}$$
Note that if your <code>x_mat</code> contains an intercept, it'll
now be a column of zeroes.</p></dd>
<dt><code>"differences_plain"</code></dt><dd><p>In some cases, you may wish to have the differences and add
customization. So here we essentially do the same as above
but with \(Y_i = 1\) for all \(i\), therefore
all differences are returned as \((X_t)_i - (X_c)_i\)
(and will also be \(m \times k\)).</p></dd>

</dl></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>list:</p><dl'>
    <dt><code>x_train</code></dt><dd><p>Design matrix for training</p></dd>
    <dt><code>x_test</code></dt><dd><p>Design matrix for testing</p></dd>
    <dt><code>y_train</code></dt><dd><p>Training outcome vector</p></dd>
    <dt><code>y_test</code></dt><dd><p>Test outcome vector</p></dd>

</dl>

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>This function gives various potential design matrix shapes
and corresponding output vectors that all can be used to solve the
above prediction problem. In some scenarios (e.g. if we were content
to use linear models), differences alone might be appropriate. For full
generality, we may wish to use both full vectors.</p>

  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Colman Humphrey.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


