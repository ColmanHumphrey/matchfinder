<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="It is not immediately clear how to take a match (set of matched pairs)
and &quot;predict&quot; it - essentially you likely want some prediction
function \(f(x, y) -&amp;gt; {0, 1}\) (or \(P(1)\) etc) where \(x\)
and \(y\) are rows, one of which is treated and the other control.
This function should also have a property resembling:
$$f(x, y) = 1 - f(y, x)$$ since there's an inherent symmetry
in the pairs: if you knew which of the two came first, there'd
be nothing to do. In fact, the definition of \(f\) would likely be
to predict if (WLOG) \(x\) is the treated unit or not."><title>Prepares design matrices and other inputs needed for predictive methods — predict_prepare • matchfinder</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.1.0/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.1.0/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Prepares design matrices and other inputs needed for predictive methods — predict_prepare"><meta property="og:description" content="It is not immediately clear how to take a match (set of matched pairs)
and &quot;predict&quot; it - essentially you likely want some prediction
function \(f(x, y) -&amp;gt; {0, 1}\) (or \(P(1)\) etc) where \(x\)
and \(y\) are rows, one of which is treated and the other control.
This function should also have a property resembling:
$$f(x, y) = 1 - f(y, x)$$ since there's an inherent symmetry
in the pairs: if you knew which of the two came first, there'd
be nothing to do. In fact, the definition of \(f\) would likely be
to predict if (WLOG) \(x\) is the treated unit or not."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">matchfinder</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.1</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"></ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Prepares design matrices and other inputs needed for predictive methods</h1>
      
      <div class="d-none name"><code>predict_prepare.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>It is not immediately clear how to take a match (set of matched pairs)
and "predict" it - essentially you likely want some prediction
function \(f(x, y) -&gt; {0, 1}\) (or \(P(1)\) etc) where \(x\)
and \(y\) are rows, one of which is treated and the other control.
This function should also have a property resembling:
$$f(x, y) = 1 - f(y, x)$$ since there's an inherent symmetry
in the pairs: if you knew which of the two came first, there'd
be nothing to do. In fact, the definition of \(f\) would likely be
to predict if (WLOG) \(x\) is the treated unit or not.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">predict_prepare</span><span class="op">(</span></span>
<span>  <span class="va">x_mat</span>,</span>
<span>  <span class="va">index_list</span>,</span>
<span>  design <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"cross_all"</span>, <span class="st">"cross_random"</span>, <span class="st">"differences_random"</span>, <span class="st">"differences_plain"</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>x_mat</dt>
<dd><p>original data, i.e. row for each unit</p></dd>


<dt>index_list</dt>
<dd><p>list of indices to use in the matching:</p><dl><dt><code>treat_train</code></dt>
<dd><p>Index of treated units for the training matrix</p></dd>

<dt><code>control_train</code></dt>
<dd><p>Index of control units for the training matrix</p></dd>

<dt><code>treat_test</code></dt>
<dd><p>Index of treated units for the test matrix</p></dd>

<dt><code>control_test</code></dt>
<dd><p>Index of control units for the test matrix</p></dd>


</dl></dd>


<dt>design</dt>
<dd><p>The design matrix form do you want to use.
We'll assume that <code>x_mat</code> is \(n \times k\).
Let \(X_c\) be the rows of <code>x_mat</code> corresponding
to the control units, and \(X_t\) the treated units that
pair with \(X_c\) (i.e. so the \(i^{\text{th}}\) matched
pair will correspond with the \(i^{\text{th}}\) row of each),
and thus each matrix will have dimension \(m \times k\),
where \(2m \leq n\).</p><dl><dt><code>"cross_all"</code></dt>
<dd><p>This will form the \(2m \times 2k\) matrix, by having each matched pair
give two rows in the design matrix: each of the two
rows will contain the full treated row of the given pair along with the full
control row, but in one row the pair will be (treated, control), and in the other
(control, treated). For these two rows, the output vector will contain a 1 and a 0
respectively. We construct the following inputs:
$$X =
    \begin{bmatrix}
    X_t&amp; X_c \\
    X_c&amp; X_t \\
    \end{bmatrix}, Y = [1 1 \ldots 1 0 0 \ldots 0]'
  $$
For the test data, we'll only (WLOG more or less) give the (treat, control)
version, for consistency in evaluation.</p></dd>

<dt><code>"cross_random"</code></dt>
<dd><p>This is similar to the above, except instead of forming all rows in both
ways, we choose (for each pair) between (treated, control) and
(control, treated) randomly. So
$$Y_i =
  \begin{cases}
  1 &amp; \text{with probability} 0.5 \\
  0 &amp; \text{with probability} 0.5
  \end{cases}$$
And (\(X_i\) here meaning the \(i^{\text{th}}\) row of the design matrix):
$$X_i =
  \begin{cases}
  ((X_t)_i, (X_c)_i) &amp; Y_i = 1 \\
  ((X_c)_i, (X_t)_i) &amp; Y_i = 0
  \end{cases}$$
Giving an \(m \times 2k\) design matrix.</p></dd>

<dt><code>"differences_random"</code></dt>
<dd><p>For
each pair, our design row will be
the row in <code>x_mat</code> corresponding to
one unit minus the row corresponding to the
other. Similar to the above, we'll choose
the outcome randomly and decide which unit will
be subtracted from the other based on that, and we'll end up with
an \(m \times k\) matrix.
That is:
$$Y_i =
  \begin{cases}
  1 &amp; \text{with probability} 0.5 \\
  0 &amp; \text{with probability} 0.5
  \end{cases}$$
And:
$$X_i =
  \begin{cases}
  (X_t)_i - (X_c)_i &amp; Y_i = 1 \\
  (X_c)_i - (X_t)_i &amp; Y_i = 0
  \end{cases}$$
Note that if your <code>x_mat</code> contains an intercept, it'll
now be a column of zeroes.</p></dd>

<dt><code>"differences_plain"</code></dt>
<dd><p>In some cases, you may wish to have the differences and add
customization. So here we essentially do the same as above
but with \(Y_i = 1\) for all \(i\), therefore
all differences are returned as \((X_t)_i - (X_c)_i\)
(and will also be \(m \times k\)).</p></dd>


</dl></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>list:</p><dl><dt><code>x_train</code></dt>
<dd><p>Design matrix for training</p></dd>

<dt><code>x_test</code></dt>
<dd><p>Design matrix for testing</p></dd>

<dt><code>y_train</code></dt>
<dd><p>Training outcome vector</p></dd>

<dt><code>y_test</code></dt>
<dd><p>Test outcome vector</p></dd>


</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>This function gives various potential design matrix shapes
and corresponding output vectors that all can be used to solve the
above prediction problem. In some scenarios (e.g. if we were content
to use linear models), differences alone might be appropriate. For full
generality, we may wish to use both full vectors.</p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Colman Humphrey</p>
    </div>

  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Colman Humphrey, Ryan Gross.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.5.</p>
</div>

    </footer></div>

  

  

  </body></html>

